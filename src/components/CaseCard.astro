---
import { Image } from 'astro:assets';
// CaseStudyCard.astro - Dynamic component for displaying case studies
interface Metric {
  value: string;
  label: string;
}

export interface Props {
  category: string;
  title: string;
  description: string;
  image?: ImageMetadata;
  imageAlt: string;
  metrics: Metric[];
  buttonLink?: string;
  buttonText?: string;
  Card?: boolean; // Add this to fix TypeScript error with component self-reference
}

const {
  category,
  title,
  description,
  image,
  imageAlt = "Client success story image",
  metrics = [],
  buttonLink = "#",
  buttonText = "Read Full Story",
} = Astro.props;
---

<div class="case-study-card bg-white rounded-xl overflow-hidden shadow-sm">
  <div class="case-study-image bg-slate-100 w-full aspect-[16/9] overflow-hidden">
    {image ? (
      <Image src={image} alt={imageAlt} class="w-full h-full object-cover" />
    ) : (
      <div class="w-full h-full flex items-center justify-center">
        <p class="text-gray-500 italic text-sm">{imageAlt}</p>
        <slot name="image" />
      </div>
    )}
  </div>
  
  <div class="p-6 xl:p-8">
    <div class="category text-accent text-sm font-medium mb-2">{category}</div>
    <h3 class="text-xl font-bold mb-3">{title}</h3>
    <p class="text-gray-700 mb-6">{description}</p>
    
    <div class="metrics grid grid-cols-2 gap-4 mb-6">
      {metrics.map((metric) => (
        <div class="metric">
          <div class="value font-bold text-2xl">{metric.value}</div>
          <div class="label text-sm text-gray-600">{metric.label}</div>
        </div>
      ))}
    </div>
    
    <a href={buttonLink} class="inline-block py-3 px-6 bg-primary text-accent font-medium rounded-full text-center w-full">
      {buttonText}
    </a>
  </div>
</div>

<style>
  .case-study-card {
    height: 100%;
    display: flex;
    flex-direction: column;
  }
  
  .case-study-card > div:last-child {
    flex: 1;
    display: flex;
    flex-direction: column;
  }
  
  .case-study-card a {
    margin-top: auto;
  }
  
  .metrics {
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
  }
</style>
